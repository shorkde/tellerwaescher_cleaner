// Generated by CoffeeScript 1.3.1
(function() {

  $(function() {
    window.FilterView = Backbone.View.extend({
      id: "FilterView",
      events: {
        'keyup input#searchForm': 'keyLog'
      },
      initialize: function() {
        return _.bindAll(this, 'render', 'getData');
      },
      keyLog: function() {
        if (typeof this.keyTimeout !== "undefined") {
          window.clearTimeout(this.keyTimeout);
        }
        return this.keyTimeout = window.setTimeout(this.getData, 500);
      },
      getData: function() {
        this.collection.query.searchstring = $('input', this.el).val();
        return this.collection.fetch();
      },
      render: function() {
        $(this.el).html(Mustache.to_html($("#FilterView-template").html(), null));
        return this;
      }
    });
    window.SearchView = Backbone.View.extend({
      template: Utility.create_template("#SearchView-template"),
      initialize: function() {
        this.recipeResultView = new RecipeResultView({
          collection: this.collection
        });
        return this.filterView = new FilterView({
          collection: this.collection
        });
      },
      render: function() {
        console.log("search view render");
        $(this.el).append(this.filterView.render().el);
        $(this.el).append(this.recipeResultView.render().el);
        this.collection.fetch();
        return this;
      }
    });
    window.RecipeResultView = Backbone.View.extend({
      tagName: "table",
      className: "table table-striped table-bordered",
      id: "RecipeResults",
      initialize: function() {
        _.bindAll(this, 'render');
        return this.collection.bind("reset", this.render);
      },
      render: function() {
        $(this.el).html("");
        this.collection.each(function(item) {
          var ingr;
          console.log("iterate");
          ingr = new RecipeListElementView({
            model: item
          });
          return $("table#RecipeResults").append(ingr.render().el);
        });
        return this;
      }
    });
    window.RecipeListElementView = Backbone.View.extend({
      template: Utility.create_template("#RecipeListViewElement-template"),
      tagName: "tr",
      initialize: function() {
        return _.bindAll(this, 'render');
      },
      render: function() {
        $(this.el).html(this.template(this.model.toJSON()));
        return this;
      }
    });
    window.RecipeDetailView = Backbone.View.extend({
      initialize: function() {
        _.bindAll(this, 'render');
        this.topBarView = new TopBarView();
        return this.recipeDataView = new RecipeDataView({
          model: this.model
        });
      },
      render: function() {
        $(this.el).append(this.topBarView.render().el);
        $(this.el).append(this.recipeDataView.render().el);
        return this;
      }
    });
    window.RecipeDataView = Backbone.View.extend({
      template: Utility.create_template("#RecipeDataView-template"),
      id: "recipeData",
      initialize: function() {
        _.bindAll(this, 'render');
        return this.model.bind("change", this.render);
      },
      render: function() {
        $(this.el).html(this.template(this.model.toJSON()));
        return this;
      }
    });
    return window.TopBarView = Backbone.View.extend({
      template: Utility.create_template("#TopBarView-template"),
      id: "topbar",
      initialize: function() {
        return _.bindAll(this, 'render');
      },
      render: function() {
        $(this.el).html(this.template(null));
        return this;
      }
    });
  });

}).call(this);
